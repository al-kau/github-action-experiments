name: Select jobs experiment

on: # yamllint disable-line rule:truthy
  workflow_dispatch:
  
jobs:
  prepare-matrix:
    runs-on: ubuntu-latest
    outputs:
      job-list: ${{ steps.jobs.outputs.list }}

    steps:
      - name: Define Colors
        id: jobs
        run: |
          job_list=${{ join(fromJSON('["job-1", "ignore-job-2", "job-3"]'), ' ') }}
          echo "$job_list"
          echo 'list=job_list' >> "$GITHUB_OUTPUT"
          
  job-1:
    runs-on: ubuntu-latest
    needs: prepare-matrix
    if: ${{ contains(needs.prepare-matrix.outputs.job-list, 'job-1') }}
    steps:
      - name: job-1 process
        run: |
          echo 'job-1'

  job-2:
    runs-on: ubuntu-latest
    needs: prepare-matrix
    if: ${{ contains(needs.prepare-matrix.outputs.job-list, 'job-2') }}
    steps:
      - name: job-2 process
        run: |
          echo 'job-2'

  job-3:
    runs-on: ubuntu-latest
    needs: prepare-matrix
    if: ${{ contains(needs.prepare-matrix.outputs.job-list, 'job-3') }}
    steps:
      - name: job-3 process
        run: |
          echo 'job-3'
